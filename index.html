<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fajar & Prita Planner 2.0</title>

    <style>
      body {
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #ffdde1, #ee9ca7);
    padding: 20px;
    margin: 0;
}

.container {
    max-width: 1100px;
    margin: auto;
}

h2 {
    text-align: center;
    margin-bottom: 40px;
    color: white;
    font-size: 28px;
    letter-spacing: 1px;
}

/* ===== PERSON CARD ===== */
.card {
    background: rgba(255, 255, 255, 0.95);
    padding: 25px;
    border-radius: 25px;
    margin-bottom: 40px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    transition: 0.3s ease;
    backdrop-filter: blur(10px);
}

.card:hover {
    transform: translateY(-5px);
}

.card h3 {
    font-size: 22px;
    margin-bottom: 15px;
    border-bottom: 2px solid #ffd1dc;
    padding-bottom: 8px;
}

/* ===== CATEGORY BOX ===== */
.category {
    margin-top: 25px;
    padding: 18px;
    background: linear-gradient(145deg, #ffffff, #fff4f7);
    border-radius: 18px;
    border: 1px solid #ffe0e6;
    box-shadow: 0 8px 20px rgba(255, 105, 135, 0.08);
    transition: 0.3s;
}

.category:hover {
    box-shadow: 0 10px 25px rgba(255, 105, 135, 0.15);
}

.category-title {
    font-weight: 600;
    font-size: 16px;
    color: #ff4d6d;
}

/* garis pemisah elegan */
.category::after {
    content: "";
    display: block;
    height: 1px;
    background: linear-gradient(to right, transparent, #ffd1dc, transparent);
    margin-top: 15px;
}

/* ===== TASK STYLE ===== */
.task {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    margin-top: 10px;
    background: white;
    border-radius: 12px;
    border: 1px solid #f3d6dc;
    transition: 0.2s;
}

.task:hover {
    background: #fff6f9;
}

.task span {
    flex: 1;
    font-size: 14px;
}

.done {
    text-decoration: line-through;
    color: #999;
}

/* ===== INPUT & BUTTON ===== */
input[type="text"] {
    padding: 10px;
    border-radius: 12px;
    border: 1px solid #ffd1dc;
    margin-top: 8px;
    margin-bottom: 8px;
    width: 100%;
    box-sizing: border-box;
    outline: none;
    transition: 0.2s;
}

input[type="text"]:focus {
    border-color: #ff6b81;
    box-shadow: 0 0 0 3px rgba(255, 107, 129, 0.15);
}

button {
    padding: 8px 12px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    transition: 0.2s;
}

button:hover {
    transform: translateY(-2px);
}

.add-btn {
    background: linear-gradient(45deg, #ff6b81, #ff8fa3);
    color: white;
}

.edit-btn {
    background: linear-gradient(45deg, #1e90ff, #5dade2);
    color: white;
}

.delete-btn {
    background: linear-gradient(45deg, #ff4757, #ff6b81);
    color: white;
}

/* ===== GALLERY ===== */
.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 12px;
    margin-top: 15px;
}

.gallery img {
    width: 100%;
    height: 130px;
    object-fit: cover;
    border-radius: 18px;
    transition: 0.3s;
    box-shadow: 0 6px 15px rgba(0,0,0,0.15);
}

.gallery img:hover {
    transform: scale(1.05);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {

    .task {
        flex-direction: column;
        align-items: flex-start;
    }

    button {
        width: 100%;
    }

}
    </style>
</head>

<body>

    <div class="container">

        <h2>ðŸ’– Fajar & Prita Planner ðŸ’–</h2>

        <div id="app"></div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import {
            getFirestore,
            collection,
            addDoc,
            getDocs,
            updateDoc,
            deleteDoc,
            doc
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBYotQIufCWXIPhrA-DyQpxStDsfz8kSi4",
            authDomain: "fajarprita-2b216.firebaseapp.com",
            projectId: "fajarprita-2b216",
            storageBucket: "fajarprita-2b216.firebasestorage.app",
            messagingSenderId: "867641668763",
            appId: "1:867641668763:web:9cec4f97de3cdfc571023e",
            measurementId: "G-X0MX9W204B"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const people = ["Fajar", "Prita"];
        const appDiv = document.getElementById("app");

        async function loadData() {
            appDiv.innerHTML = "";
            const snapshot = await getDocs(collection(db, "planner"));

            const grouped = {};

            snapshot.forEach(docSnap => {
                const d = docSnap.data();
                if (!grouped[d.person]) grouped[d.person] = {};
                if (!grouped[d.person][d.category]) grouped[d.person][d.category] = [];
                grouped[d.person][d.category].push({ id: docSnap.id, ...d });
            });

            people.forEach(person => {
                const card = document.createElement("div");
                card.className = "card";
                card.innerHTML = `<h3>${person}</h3>
    <input type="text" placeholder="Nama kategori baru..." id="cat-${person}">
    <button class="add-btn" onclick="addCategory('${person}')">Tambah Kategori</button>
    `;

                const categories = grouped[person] || {};

                Object.keys(categories).forEach(cat => {
                    const catDiv = document.createElement("div");
                    catDiv.className = "category";
                    catDiv.innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;">
        <div class="category-title">${cat}</div>
        <div>
            <button class="edit-btn" onclick="editCategory('${person}','${cat}')">Edit</button>
            <button class="delete-btn" onclick="deleteCategory('${person}','${cat}')">Delete</button>
        </div>
    </div>

    <input type="text" placeholder="Tambah task..." id="task-${person}-${cat}">
    <button class="add-btn" onclick="addTask('${person}','${cat}')">Tambah</button>
`;

                    categories[cat].forEach(task => {
                        const taskDiv = document.createElement("div");
                        taskDiv.className = "task";

                        const checkbox = document.createElement("input");
                        checkbox.type = "checkbox";
                        checkbox.checked = task.completed;

                        const span = document.createElement("span");
                        span.textContent = task.text;
                        if (task.completed) span.classList.add("done");

                        checkbox.addEventListener("change", async () => {
                            await updateDoc(doc(db, "planner", task.id), {
                                completed: checkbox.checked
                            });
                            span.classList.toggle("done");
                        });

                        const editBtn = document.createElement("button");
                        editBtn.textContent = "Edit";
                        editBtn.className = "edit-btn";
                        editBtn.onclick = async () => {
                            const newText = prompt("Edit task:", task.text);
                            if (newText) {
                                await updateDoc(doc(db, "planner", task.id), { text: newText });
                                loadData();
                            }
                        };

                        const deleteBtn = document.createElement("button");
                        deleteBtn.textContent = "Delete";
                        deleteBtn.className = "delete-btn";
                        deleteBtn.onclick = async () => {
                            await deleteDoc(doc(db, "planner", task.id));
                            loadData();
                        };

                        taskDiv.appendChild(checkbox);
                        taskDiv.appendChild(span);
                        taskDiv.appendChild(editBtn);
                        taskDiv.appendChild(deleteBtn);

                        catDiv.appendChild(taskDiv);
                    });

                    card.appendChild(catDiv);
                });

                appDiv.appendChild(card);
            });
        }

        window.addCategory = async function (person) {
            const input = document.getElementById("cat-" + person);
            if (!input.value.trim()) return;

            await addDoc(collection(db, "planner"), {
                person: person,
                category: input.value,
                text: "(Kategori dibuat)",
                completed: false,
                createdAt: new Date()
            });

            input.value = "";
            loadData();
        };

        window.addTask = async function (person, category) {
            const input = document.getElementById(`task-${person}-${category}`);
            if (!input.value.trim()) return;

            await addDoc(collection(db, "planner"), {
                person: person,
                category: category,
                text: input.value,
                completed: false,
                createdAt: new Date()
            });

            input.value = "";
            loadData();
        };

        window.editCategory = async function(person, oldCategory){

    const newCategory = prompt("Ubah nama kategori:", oldCategory);
    if(!newCategory || newCategory === oldCategory) return;

    const snapshot = await getDocs(collection(db, "planner"));

    const promises = [];

    snapshot.forEach(docSnap=>{
        const data = docSnap.data();
        if(data.person === person && data.category === oldCategory){
            promises.push(
                updateDoc(doc(db,"planner",docSnap.id),{
                    category: newCategory
                })
            );
        }
    });

    await Promise.all(promises);
    loadData();
};

window.deleteCategory = async function(person, category){

    const confirmDelete = confirm("Hapus kategori dan semua task di dalamnya?");
    if(!confirmDelete) return;

    const snapshot = await getDocs(collection(db, "planner"));

    const promises = [];

    snapshot.forEach(docSnap=>{
        const data = docSnap.data();
        if(data.person === person && data.category === category){
            promises.push(
                deleteDoc(doc(db,"planner",docSnap.id))
            );
        }
    });

    await Promise.all(promises);
    loadData();
};


        loadData();
    </script>

    <div class="card">
        <h3 style="text-align:center;">ðŸ“¸ Our Memories ðŸ’–</h3>

        <div class="gallery">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto1">
            <img src="foto/IMG-20260214-WA0020.jpg.jpeg" alt="foto2">
            <img src="foto/IMG-20260214-WA0021.jpg.jpeg" alt="foto3">
            <img src="foto/IMG-20260218-WA0037.jpeg" alt="foto4">
            <img src="foto/IMG-20260221-WA0013.jpg.jpeg" alt="foto5">
            <img src="foto/f55c2abb-77d1-430d-bde3-83bb020a26d7.png" alt="foto6">
            <img src="foto/f9c3f014-6d9a-46d0-8478-860cd66886c6.png" alt="foto7">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto8">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto9">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto10">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto11">
            <img src="foto/FOTO FAJAR SIDIK.jpg" alt="foto12">
        </div>
    </div>
</body>

</html>


